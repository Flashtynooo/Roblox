local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

_G.g_antiFling = true

-- On garde en mémoire les parties que NOUS avons modifiées (et uniquement celles-là)
local modifiedParts = {}

local function AntiFling()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            for _, part in pairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    if _G.g_antiFling then
                        if part.CanCollide == true then
                            part.CanCollide = false
                            modifiedParts[part] = true
                        end
                        part.Velocity = Vector3.new(0, 0, 0)
                        part.RotVelocity = Vector3.new(0, 0, 0)
                    else
                        if modifiedParts[part] then
                            part.CanCollide = true
                            modifiedParts[part] = nil
                        end
                    end
                end
            end
        end
    end
end

RunService.Heartbeat:Connect(function()
    pcall(AntiFling)
end)

print("✅ Anti-Fling activable/désactivable sans affecter les objets déjà noclip")
