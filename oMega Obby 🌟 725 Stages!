-- Cr√©ation du ScreenGui
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "OmegaObbyHub"

-- Cr√©ation du cadre principal (hub)
local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 300, 0, 250)
main.Position = UDim2.new(0.5, -150, 0.5, -125) -- Centr√©
main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
main.BackgroundTransparency = 0.1
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true

-- Titre du hub
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = "oMega Obby üåü 725 Stages!"
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Bouton "Finish Obby"
local finishButton = Instance.new("TextButton", main)
finishButton.Size = UDim2.new(0, 200, 0, 40)
finishButton.Position = UDim2.new(0.5, -100, 0.3, -20) -- Centr√© dans le hub
finishButton.Text = "Finish Obby OFF"
finishButton.BackgroundColor3 = Color3.fromRGB(120, 40, 40) -- Rouge pour OFF
finishButton.TextColor3 = Color3.fromRGB(255, 255, 255)
finishButton.Font = Enum.Font.Gotham
finishButton.TextSize = 16

-- Bouton "Get inf Prestige"
local prestigeButton = Instance.new("TextButton", main)
prestigeButton.Size = UDim2.new(0, 200, 0, 40)
prestigeButton.Position = UDim2.new(0.5, -100, 0.7, -20) -- Sous le premier bouton
prestigeButton.Text = "Get inf Prestige OFF"
prestigeButton.BackgroundColor3 = Color3.fromRGB(120, 40, 40) -- Rouge pour OFF
prestigeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
prestigeButton.Font = Enum.Font.Gotham
prestigeButton.TextSize = 16

-- Variables pour g√©rer l'√©tat
local isFinishLooping = false
local isPrestigeLooping = false

-- Fonction pour ex√©cuter la logique de t√©l√©portation pour "Finish Obby"
local function finishObbyLoop()
    local player = game.Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local root = character:WaitForChild("HumanoidRootPart")
    local leaderstats = player:WaitForChild("leaderstats")
    local stageValue = leaderstats:WaitForChild("Stage")
    local stagesFolder = workspace:WaitForChild("Stages")

    local function teleportToStage(stageNumber)
        local stage = stagesFolder:FindFirstChild(tostring(stageNumber))
        if stage and stage:FindFirstChild("Spawn") then
            root.CFrame = stage.Spawn.CFrame + Vector3.new(0, 3, 0)
            print("T√©l√©port√© au stage " .. stageNumber)
            return true
        end
        warn("Stage " .. stageNumber .. " introuvable ou pas de spawn")
        return false
    end

    while isFinishLooping do
        local currentStage = stageValue.Value
        local nextStage = currentStage + 1
        local success = teleportToStage(nextStage)

        if not success then
            warn("Fin du script - Stage " .. nextStage .. " introuvable")
            break
        end

        -- Attendre que le joueur valide le stage
        local startTime = tick()
        while stageValue.Value < nextStage and (tick() - startTime) < 3 do
            task.wait(0.1)
        end

        if stageValue.Value >= nextStage then
            print("Stage valid√© : " .. stageValue.Value)
        else
            warn("Validation du stage √©chou√©e, r√©essai...")
        end

        -- Pause entre les t√©l√©portations
        task.wait(0.1)
    end
end

-- Gestion de la r√©apparition pour "Finish Obby"
game.Players.LocalPlayer.CharacterAdded:Connect(function()
    if isFinishLooping then
        print("Le joueur a r√©apparu. Reprise du script 'Finish Obby'.")
        task.spawn(finishObbyLoop)
    end
end)

-- Fonction pour ex√©cuter la logique de t√©l√©portation pour "Get inf Prestige"
local function prestigeLoop()
    local player = game.Players.LocalPlayer
    local targetPosition = Vector3.new(-1129.19397, 533.700989, 510.705505)

    while isPrestigeLooping do
        local character = player.Character or player.CharacterAdded:Wait()
        local root = character:FindFirstChild("HumanoidRootPart")

        if root then
            -- V√©rification de la position cible
            if (root.Position - targetPosition).Magnitude < 1 then
                print("Le joueur est √† la position Winners Part. R√©initialisation...")
                player.Character:BreakJoints() -- R√©initialise le joueur
            else
                -- T√©l√©portation √† Restart Obby Part
                local part = workspace:FindFirstChild("Restart Obby") and workspace["Restart Obby"]:FindFirstChild("Part")
                if part then
                    root.CFrame = part.CFrame + Vector3.new(0, 3, 0)
                    print("T√©l√©port√© √† Restart Obby Part.")
                else
                    warn("La Part dans Restart Obby est introuvable.")
                end
            end
        else
            print("HumanoidRootPart introuvable, attente...")
        end

        -- Pause de 2 secondes
        task.wait(2)
    end
end

-- Gestion du clic du bouton "Finish Obby"
finishButton.MouseButton1Click:Connect(function()
    if isFinishLooping then
        -- Arr√™ter la boucle
        isFinishLooping = false
        finishButton.Text = "Finish Obby OFF"
        finishButton.BackgroundColor3 = Color3.fromRGB(120, 40, 40) -- Rouge
        print("Script 'Finish Obby' arr√™t√©.")
    else
        -- D√©marrer la boucle
        isFinishLooping = true
        finishButton.Text = "Finish Obby ON"
        finishButton.BackgroundColor3 = Color3.fromRGB(40, 120, 40) -- Vert
        print("Script 'Finish Obby' d√©marr√©.")
        -- Lancer la boucle
        task.spawn(finishObbyLoop)
    end
end)

-- Gestion du clic du bouton "Get inf Prestige"
prestigeButton.MouseButton1Click:Connect(function()
    if isPrestigeLooping then
        -- Arr√™ter la logique
        isPrestigeLooping = false
        prestigeButton.Text = "Get inf Prestige OFF"
        prestigeButton.BackgroundColor3 = Color3.fromRGB(120, 40, 40) -- Rouge
        print("Script 'Get inf Prestige' arr√™t√©.")
    else
        -- D√©marrer la logique
        isPrestigeLooping = true
        prestigeButton.Text = "Get inf Prestige ON"
        prestigeButton.BackgroundColor3 = Color3.fromRGB(40, 120, 40) -- Vert
        print("Script 'Get inf Prestige' d√©marr√©.")
        -- Lancer la boucle
        task.spawn(prestigeLoop)
    end
end)
