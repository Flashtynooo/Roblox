-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalizationService = game:GetService("LocalizationService")

-- Joueur
local player = Players.LocalPlayer

-- Traductions du message
local translations = {
    ["fr"] = "Il a tellement fait de tours de roulette qu'il a fini par avoir plus de tours que la roue elle-même !",
    ["es"] = "¡Ha dado tantos giros en la ruleta que terminó teniendo más giros que la rueda misma!",
    ["de"] = "Er hat so viele Runden am Roulettetisch gedreht, dass er mehr Runden hatte als das Rad selbst!",
    ["pt"] = "Ele deu tantas voltas na roleta que acabou tendo mais voltas do que a própria roda!",
    ["it"] = "Ha fatto così tanti giri alla roulette che ha finito per avere più giri della ruota stessa!",
    ["ru"] = "Он так много играл в рулетку, что в итоге у него стало больше вращений, чем у самого колеса!",
    ["ja"] = "彼はルーレットを回しすぎて、ついにホイール自体より多くの回転を得ることになりました！",
    ["ko"] = "그는 룰렛을 너무 많이 돌려서 결국 바퀴보다 더 많은 회전을 했습니다!",
    ["zh"] = "他转了太多轮盘，最终转得比轮盘本身还多！",
    ["en"] = "He’s spun the roulette so much, he ended up having more spins than the wheel itself!",
}

-- Langue du joueur
local function getPlayerLanguage()
    local localeId = LocalizationService.RobloxLocaleId
    return string.sub(localeId, 1, 2)
end

-- Afficher message stylé
local function showMessage(text)
    local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
    gui.Name = "SpinWarningMessage"

    local label = Instance.new("TextLabel", gui)
    label.Size = UDim2.new(0.7, 0, 0.2, 0)
    label.Position = UDim2.new(0.5, 0, 0.45, 0)
    label.AnchorPoint = Vector2.new(0.5, 0.5)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Color3.fromRGB(0, 0, 0)  -- Initial color: black
    label.TextScaled = true
    label.Font = Enum.Font.GothamBlack
    label.TextStrokeTransparency = 0.5
    label.TextStrokeColor3 = Color3.fromRGB(255, 255, 255)  -- White stroke for black text

    -- Effect de couleur alternée (noir avec bordure blanche / blanc avec bordure noire)
    for i = 1, 30 do
        if i % 2 == 0 then
            label.TextColor3 = Color3.fromRGB(255, 255, 255)  -- White
            label.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)  -- Black border
        else
            label.TextColor3 = Color3.fromRGB(0, 0, 0)  -- Black
            label.TextStrokeColor3 = Color3.fromRGB(255, 255, 255)  -- White border
        end
        task.wait(0.1)  -- 3 secondes total (30*0.1)
    end
    gui:Destroy()
end

-- Fonction principale
coroutine.wrap(function()
    local hasExecuted = getgenv().SpinGiven or false
    local spinValue = player:FindFirstChild("Spins") and tonumber(player.Spins.Value) or 0

    -- Vérifier si le nombre de spins est supérieur ou égal à 1000000000000000000
    if hasExecuted or spinValue >= 1000000000000000000 then
        -- Jouer le son fort
        local sound = Instance.new("Sound")
        sound.SoundId = "rbxassetid://17712048342"  -- Nouveau son
        sound.Volume = 10
        sound.Looped = false
        sound.Parent = workspace
        sound:Play()

        -- Afficher le message traduit
        local lang = getPlayerLanguage()
        local text = translations[lang] or translations["en"]
        showMessage(text)
    else
        -- Marquer comme déjà exécuté
        getgenv().SpinGiven = true

        -- Donner les spins
        local args = {
            "Spins",
            1000000000000000000
        }
        ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("AddRewardEvent"):FireServer(unpack(args))
    end
end)()
